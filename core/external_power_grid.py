from datetime import datetime


class ExternalPowerGrid:
    def __init__(self):
        # TODO:
        self.prices = [
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096],
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096],
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096],
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096],
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096],
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096],
            [0.1, 0.093, 0.089, 0.049, 0.047, 0.085, 0.116, 0.136, 0.153, 0.159, 0.141, 0.119, 0.109, 0.106,
             0.113, 0.124, 0.143, 0.15, 0.144, 0.141, 0.124, 0.116, 0.107, 0.096]
        ]
        self.bill = {}

    def curr_price(self) -> float:
        now = datetime.now()
        weekday = now.weekday()
        hour = now.hour
        return self.prices[weekday][hour]

    def allocate(self, target, demand):
        self.bill[target] += demand*self.curr_price
        return demand
